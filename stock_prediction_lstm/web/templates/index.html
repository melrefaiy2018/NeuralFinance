<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Stock AI Dashboard</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts - Inter -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        /* Custom scrollbar for better aesthetics */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #555;
        }
        .active-tab {
            border-color: #4f46e5 !important;
            color: #4f46e5 !important;
        }
    </style>
</head>
<body class="flex flex-col min-h-screen bg-gray-100 text-gray-800">

    <!-- 1. Global Header -->
    <header class="bg-white shadow-md p-4 flex justify-between items-center sticky top-0 z-10">
        <div class="flex items-center">
            <!-- App Logo -->
            <svg class="w-8 h-8 text-indigo-600 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7h8m0 0v8m0-8L11 2m7 12v3m-3 3h6m-3-6v6"></path>
            </svg>
            <h1 class="text-2xl font-bold text-gray-900">Stock AI</h1>
        </div>
        <!-- Market Status -->
        <div class="text-sm">
            <span class="text-gray-600">Market Status:</span>
            <span class="font-medium {% if market_state == 'open' %}text-green-600{% else %}text-red-600{% endif %}">
                {{ market_state|title }}
            </span>
        </div>
        <!-- Global Settings/User Icon -->
        <button class="text-gray-600 hover:text-indigo-600 focus:outline-none">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"></path>
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
            </svg>
        </button>
    </header>

    <main class="flex flex-1 flex-col md:flex-row">
        <!-- 2. Dynamic Input Panel (Left Sidebar) -->
        <aside class="w-full md:w-80 bg-white p-6 shadow-lg md:shadow-none md:border-r border-gray-200 flex-shrink-0">
            <h2 class="text-xl font-semibold mb-6 text-gray-900">Analysis Parameters</h2>

            <form id="analysis-form" action="{{ url_for('analysis') }}" method="POST">
                <div class="mb-5">
                    <label for="ticker_symbol" class="block text-sm font-medium text-gray-700 mb-1">Stock Ticker</label>
                    <input type="text" id="ticker_symbol" name="ticker_symbol" value="NVDA" placeholder="e.g., AAPL, MSFT"
                           class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm p-3 border">
                    <p class="text-xs text-gray-500 mt-1">Popular tickers: AAPL, MSFT, GOOGL, AMZN, TSLA</p>
                </div>

                <div class="mb-5">
                    <label for="period" class="block text-sm font-medium text-gray-700 mb-1">Select Time Period</label>
                    <select id="period" name="period" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm p-3 border">
                        <option value="1y">1 Year</option>
                        <option value="2y" selected>2 Years</option>
                        <option value="5y">5 Years</option>
                        <option value="max">Max</option>
                    </select>
                </div>

                <div class="mb-5">
                    <label for="interval" class="block text-sm font-medium text-gray-700 mb-1">Select Interval</label>
                    <select id="interval" name="interval" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm p-3 border">
                        <option value="1h">1 Hour</option>
                        <option value="1d" selected>1 Day</option>
                        <option value="1wk">1 Week</option>
                    </select>
                </div>

                <div class="mb-6">
                    <label for="prediction_days" class="block text-sm font-medium text-gray-700 mb-1">Days to Predict</label>
                    <input type="number" id="prediction_days" name="prediction_days" value="5" min="1" max="30"
                           class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm p-3 border">
                    <p class="text-xs text-gray-500 mt-1">Forecasting <span id="days-predict-value">5</span> days into the future</p>
                </div>

                <button type="submit" id="run-analysis-btn" class="w-full bg-indigo-600 text-white py-3 px-4 rounded-md text-lg font-semibold hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 transition duration-200 ease-in-out shadow-md">
                    Run Analysis
                </button>
            </form>

            <div class="mt-8">
                <h3 class="text-lg font-medium text-gray-900 mb-3">
                    Market Status: 
                    <span class="font-normal {% if market_state == 'open' %}text-green-500{% else %}text-red-500{% endif %}">
                        {{ market_state|title }}
                    </span>
                </h3>

                <!-- Popular Stocks Quick Access -->
                {% if popular_stocks %}
                <div class="rounded-md bg-gray-50 p-4 mb-4">
                    <h4 class="text-sm font-medium text-gray-700 mb-3">Popular Stocks</h4>
                    <div class="grid grid-cols-2 gap-2">
                        {% for stock in popular_stocks %}
                        <button type="button" class="popular-stock-btn text-left p-2 text-sm bg-white rounded border hover:bg-indigo-50 hover:border-indigo-300 transition-colors" 
                                data-ticker="{{ stock.ticker }}">
                            <div class="font-medium">{{ stock.ticker }}</div>
                            <div class="text-xs text-gray-500 truncate">{{ stock.name }}</div>
                        </button>
                        {% endfor %}
                    </div>
                </div>
                {% endif %}

                <!-- Collapsible Help Information -->
                <div class="rounded-md bg-gray-50 p-4">
                    <button class="flex justify-between items-center w-full text-left text-gray-700 font-medium" onclick="toggleAccordion('help-info')">
                        Help & Tips
                        <svg class="w-5 h-5 transform transition-transform duration-200" id="help-info-arrow" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                    </button>
                    <div id="help-info-content" class="mt-3 text-sm text-gray-600 hidden">
                        <p><strong>Stock Ticker:</strong> Enter the stock symbol (e.g., AAPL for Apple Inc.)</p>
                        <p><strong>Time Period:</strong> Historical data range for training the model</p>
                        <p><strong>Interval:</strong> Data frequency (daily recommended for most analysis)</p>
                        <p><strong>Prediction Days:</strong> Number of future days to forecast</p>
                    </div>
                </div>
            </div>
        </aside>

        <!-- 3. Main Content Area: Welcome Screen / Results -->
        <section class="flex-1 p-6 md:p-8 overflow-y-auto">
            <!-- Welcome Screen (shown when no analysis is running) -->
            <div id="welcome-screen" class="flex flex-col items-center justify-center py-20 bg-white rounded-lg shadow-md">
                <div class="text-center">
                    <svg class="mx-auto h-24 w-24 text-indigo-500 mb-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path>
                    </svg>
                    <h1 class="text-4xl font-bold text-gray-900 mb-4">Welcome to Stock AI</h1>
                    <p class="text-xl text-gray-600 mb-8">Advanced LSTM-based stock price prediction with sentiment analysis</p>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 max-w-4xl mx-auto">
                        <div class="text-center p-6 bg-indigo-50 rounded-lg">
                            <div class="w-12 h-12 bg-indigo-100 rounded-lg flex items-center justify-center mx-auto mb-4">
                                <svg class="w-6 h-6 text-indigo-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                                </svg>
                            </div>
                            <h3 class="text-lg font-semibold text-gray-900 mb-2">AI-Powered Predictions</h3>
                            <p class="text-gray-600">Advanced LSTM neural networks trained on historical price data and market indicators</p>
                        </div>
                        <div class="text-center p-6 bg-green-50 rounded-lg">
                            <div class="w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center mx-auto mb-4">
                                <svg class="w-6 h-6 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 12l3-3 3 3 4-4"></path>
                                </svg>
                            </div>
                            <h3 class="text-lg font-semibold text-gray-900 mb-2">Sentiment Analysis</h3>
                            <p class="text-gray-600">Market sentiment from news and social media integrated into predictions</p>
                        </div>
                        <div class="text-center p-6 bg-purple-50 rounded-lg">
                            <div class="w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center mx-auto mb-4">
                                <svg class="w-6 h-6 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path>
                                </svg>
                            </div>
                            <h3 class="text-lg font-semibold text-gray-900 mb-2">Real-time Data</h3>
                            <p class="text-gray-600">Live market data from Yahoo Finance with comprehensive technical indicators</p>
                        </div>
                    </div>
                    <div class="mt-8">
                        <p class="text-gray-500">Select a stock ticker and click "Run Analysis" to get started</p>
                    </div>
                </div>
            </div>

            <!-- Loading Indicator -->
            <div id="loading-indicator" class="hidden flex flex-col items-center justify-center py-20 bg-white rounded-lg shadow-md">
                <div class="animate-spin rounded-full h-16 w-16 border-t-4 border-b-4 border-indigo-500"></div>
                <p class="mt-4 text-lg text-indigo-600 font-medium">Running Analysis...</p>
                <p class="text-sm text-gray-500">This may take a moment.</p>
            </div>
        </section>
    </main>

    <!-- 4. The Footer -->
    <footer class="bg-gray-800 text-gray-300 text-xs p-4 text-center">
        <p>Disclaimer: These predictions are based on historical data and machine learning models, which have inherent limitations. Past performance is not indicative of future results. This information is for educational purposes only and should not be considered financial advice. Always consult with a qualified financial advisor before making investment decisions.</p>
        <p class="mt-2">&copy; 2025 Stock AI Assistant | Powered by Machine Learning and Sentiment Analysis | Data sourced from Yahoo Finance</p>
    </footer>

    <script>
        // JavaScript for basic interactivity
        document.addEventListener('DOMContentLoaded', () => {
            const analysisForm = document.getElementById('analysis-form');
            const loadingIndicator = document.getElementById('loading-indicator');
            const welcomeScreen = document.getElementById('welcome-screen');
            const predictionDaysInput = document.getElementById('prediction_days');
            const daysPredictValue = document.getElementById('days-predict-value');
            const popularStockBtns = document.querySelectorAll('.popular-stock-btn');
            const tickerInput = document.getElementById('ticker_symbol');

            // Update days to predict text
            predictionDaysInput.addEventListener('input', () => {
                daysPredictValue.textContent = predictionDaysInput.value;
            });

            // Handle popular stock selection
            popularStockBtns.forEach(btn => {
                btn.addEventListener('click', () => {
                    const ticker = btn.dataset.ticker;
                    tickerInput.value = ticker;
                    
                    // Visual feedback
                    popularStockBtns.forEach(b => b.classList.remove('bg-indigo-100', 'border-indigo-300'));
                    btn.classList.add('bg-indigo-100', 'border-indigo-300');
                });
            });

            // Handle form submission
            analysisForm.addEventListener('submit', (e) => {
                // Show loading indicator
                welcomeScreen.classList.add('hidden');
                loadingIndicator.classList.remove('hidden');
                
                // Scroll to top
                window.scrollTo({ top: 0, behavior: 'smooth' });
            });

            // Uppercase ticker input
            tickerInput.addEventListener('input', (e) => {
                e.target.value = e.target.value.toUpperCase();
            });
        });

        // Accordion toggle function
        function toggleAccordion(id) {
            const content = document.getElementById(id + '-content');
            const arrow = document.getElementById(id + '-arrow');
            if (content.classList.contains('hidden')) {
                content.classList.remove('hidden');
                arrow.classList.add('rotate-180');
            } else {
                content.classList.add('hidden');
                arrow.classList.remove('rotate-180');
            }
        }
    </script>
</body>
</html>
